<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>PROJECT LEROY</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Project Leroy">
<meta name="theme-color" content="#080808">
<meta name="description" content="Project Leroy â€” AI-driven modular RPG campaigns.">
<link rel="manifest" href="manifest.json">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš”</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=VT323&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/game.css">
</head>
<body>
<div id="bg-ascii"></div>
<div id="app">

<!-- SPLASH / BOOT SCREEN -->
<div id="splash-screen">
  <div id="splash-boot">
    <div id="splash-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="80" height="80"><circle cx="50" cy="50" r="47" fill="#111" stroke="#333" stroke-width="1.5"/><path d="M43,38 L28,12 A44,44 0 0,1 72,12 L57,38 A14,14 0 0,0 43,38Z" fill="#BB1111"/><path d="M64,50 L94,50 A44,44 0 0,1 72,88 L57,62 A14,14 0 0,0 64,50Z" fill="#1144BB"/><path d="M43,62 L28,88 A44,44 0 0,1 6,50 L36,50 A14,14 0 0,0 43,62Z" fill="#117700"/><circle cx="50" cy="50" r="7" fill="#CCAA00"/></svg></div>
    <div id="splash-boot-title">PROJECT LEROY</div>
    <div id="splash-boot-ver">PROJECT LEROY &mdash; ALPHA BUILD 0.1</div>
    <div id="splash-bar-wrap"><div id="splash-bar-fill"></div></div>
    <div id="splash-boot-status">Initializing...</div>
  </div>
  <div id="splash-dialog" style="display:none;">
    <div class="splash-win">
      <div class="splash-tb">
        <div class="wtt"><span>&#9888;</span> PROJECTLEROY.EXE &mdash; IMPORTANT NOTICE</div>
        <div class="wbs"><div class="wbtn">&#10005;</div></div>
      </div>
      <div class="splash-body">
        <div class="splash-warn-icon">&#9888;</div>
        <div class="splash-text-area">
          <div class="splash-title-big">PROJECT LEROY</div>
          <div class="splash-disc">The names, characters, businesses, places, events, and mildly questionable life choices portrayed in this work are entirely fictional. Any resemblance to actual persons, living or dead, is purely coincidental &mdash; even if it seems oddly specific. No real individuals, corporations, secret societies, or overly sensitive uncles were intentionally depicted. Please direct all conspiracy theories elsewhere.</div>
        </div>
      </div>
      <div class="splash-footer">
        <button class="splash-ok-btn" onclick="dismissSplash()">[ ACKNOWLEDGE AND ENTER ]</button>
      </div>
    </div>
  </div>
</div>

<!-- TITLE SCREEN â€” Windows 95 desktop aesthetic -->
<div id="title-block">
<div class="wp" style="background:var(--wg);">
  <div class="wtb"><div class="wtt"><span>&#128192;</span> PROJECTLEROY.EXE &mdash; v0.1 ALPHA</div><div class="wbs"><div class="wbtn">_</div><div class="wbtn">&#9633;</div><div class="wbtn">&#10005;</div></div></div>
  <div class="wi" style="padding:0;">
    <div class="desktop-home">
      <div class="desktop-logo">
        <div class="desktop-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="50" height="50"><circle cx="50" cy="50" r="47" fill="#111" stroke="#333" stroke-width="1.5"/><path d="M43,38 L28,12 A44,44 0 0,1 72,12 L57,38 A14,14 0 0,0 43,38Z" fill="#BB1111"/><path d="M64,50 L94,50 A44,44 0 0,1 72,88 L57,62 A14,14 0 0,0 64,50Z" fill="#1144BB"/><path d="M43,62 L28,88 A44,44 0 0,1 6,50 L36,50 A14,14 0 0,0 43,62Z" fill="#117700"/><circle cx="50" cy="50" r="7" fill="#CCAA00"/></svg></div>
        <div class="desktop-titles">
          <div class="desktop-game-title">PROJECT LEROY</div>
          <div class="desktop-game-sub">Modular Campaign System</div>
        </div>
      </div>
      <div class="desktop-tagline">Claude API Gamemaster Enabled.</div>
      <div class="desktop-divider"></div>
      <div class="desktop-meta">
        <div class="desktop-meta-chip">ENGINE<span>Claude API</span></div>
        <div class="desktop-meta-chip">STATUS<span>Early Access</span></div>
        <div class="desktop-meta-chip">BUILD<span>2999 Alpha</span></div>
        <div class="desktop-meta-chip settings-chip" onclick="openSettings()">SETTINGS<span>Options &amp; Lore</span></div>
        <div class="desktop-meta-chip settings-chip" onclick="openSettings();settingsTab('tutorial')">HOW TO PLAY<span>Tutorial</span></div>
      </div>
      <div id="home-continue-row" style="display:none;margin-top:14px;width:100%;gap:8px;flex-wrap:wrap;">
        <button class="desktop-save-btn" onclick="resumeGame(window._ps)">&#9654; CONTINUE LAST SAVE</button>
      </div>
    </div>
  </div>
</div>
</div>

<!-- STORY SELECT SCREEN -->
<div id="story-select">
<div class="wp">
  <div class="wtb"><div class="wtt"><span>&#128196;</span> CAMPAIGN_SELECT.EXE &mdash; CHOOSE YOUR STORY</div><div class="wbs"><div class="wbtn">?</div></div></div>
  <div class="wi">
    <div class="story-grid">

      <!-- STORY 01: 2999 â€” LIVE -->
      <div class="story-card" id="sc-jersey" onclick="selectStory('jersey')">
        <div class="sc-banner" style="background:linear-gradient(to right,#007a1f,#00ff41,#007a1f);"></div>
        <div class="sc-inner">
          <div class="sc-top">
            <div class="sc-icon" style="color:#00ff41;">&#9873;</div>
            <div class="sc-badges">
              <div class="sc-status live">&#9679; ALPHA</div>
              <div class="sc-num">CAMPAIGN 01</div>
            </div>
          </div>
          <div class="sc-title">2999</div>
          <div class="sc-desc">Year 2999. New Jersey was abandoned in 2669 when most of Earth&rsquo;s population fled off-world and left the poor, criminals, and addicts behind on a destroyed world. Three centuries of isolation, wars, and political factions rising later &mdash; six warring city-states control what remains of the Garden State. You start in a pre-designated established faction with a name and a calling to bring order to chaos.<br><br>Unite the wasteland. Conquer it. Or get eaten by the Jersey Devil in the Pine Barrens &mdash; it&rsquo;s up to you.</div>
          <div class="sc-meta">
            <div class="sc-meta-item">MAP: <span>New Jersey, 2999</span></div>
            <div class="sc-meta-item">ENDINGS: <span>Multiple</span></div>
          </div>
          <button class="sc-select-btn" onclick="selectStory('jersey');event.stopPropagation();">[ SELECT CAMPAIGN &gt;&gt; ]</button>
        </div>
      </div>

      <!-- STORY 02: GLITTERGOLD FRONTIER â€” Coming Soon -->
      <div class="story-card space-card" id="sc-space">
        <div class="sc-banner space-banner"></div>
        <div class="sc-inner">
          <div class="sc-top">
            <div class="sc-icon">&#128640;</div>
            <div class="sc-badges">
              <div class="sc-status coming-soon">&#9670; COMING SOON</div>
              <div class="sc-num">CAMPAIGN 02</div>
            </div>
          </div>
          <div class="sc-title sc-title-purple">GLITTERGOLD FRONTIER</div>
          <div class="sc-desc space-desc">You awake from cryo sleep in the year 3150 after fleeing Earth on the Glittergold &mdash; a luxury star cruiser &mdash; as it became clear humanity&rsquo;s treatment of the planet had pushed it to its brink.<br><br>The overseers running this ship aren&rsquo;t the help the luxury clientele expected them to be. Influence an uprising, jettison the bastards out the airlock, or just go on a rampage. Someone has to.</div>
          <div class="sc-meta">
            <div class="sc-meta-item">MAP: <span>Solar System, 3150</span></div>
            <div class="sc-meta-item">ENDINGS: <span>Multiple</span></div>
          </div>
          <button class="sc-select-btn space-select-btn" disabled>[ IN DEVELOPMENT ]</button>
        </div>
      </div>

      <!-- STORY 03: BLOCK .45 â€” Coming Soon -->
      <div class="story-card red-card" id="sc-locked2">
        <div class="sc-banner" style="background:linear-gradient(to right,#4a0000,#aa2200,#4a0000);"></div>
        <div class="sc-inner">
          <div class="sc-top">
            <div class="sc-icon">&#128274;</div>
            <div class="sc-badges">
              <div class="sc-status coming-soon" style="color:#cc2222;border-color:#cc2222;">&#9670; COMING SOON</div>
              <div class="sc-num">CAMPAIGN 03</div>
            </div>
          </div>
          <div class="sc-title sc-title-red">BLOCK .45</div>
          <div class="sc-desc sc-desc-dim">Year 2027. You did your tours, you served your time, and you came home to Chicago expecting the same rundown block you grew up on. Instead you find it&rsquo;s been swallowed whole by a gang that doesn&rsquo;t negotiate, doesn&rsquo;t back down, and definitely doesn&rsquo;t remember you.<br><br>They should have picked a different block. Capture evidence to build a case, kill them off, or die trying. This is your home.</div>
          <div class="sc-meta">
            <div class="sc-meta-item">MAP: <span>O-Block, 2027</span></div>
            <div class="sc-meta-item">ENDINGS: <span>Multiple</span></div>
          </div>
          <button class="sc-select-btn sc-select-btn-red" disabled>[ IN DEVELOPMENT ]</button>
        </div>
      </div>

    </div>
  </div>
</div>
</div>

<!-- SETUP SCREEN -->
<div id="setup-screen" style="display:none;">
  <button class="back-to-stories" onclick="backToStories()">&#8592; BACK TO CAMPAIGN SELECT</button>
  <div class="story-badge-strip" id="setup-story-badge">
    <div class="story-badge-name" id="setup-story-name">JERSEY WASTELAND 2999</div>
    <div class="story-badge-tag">SELECTED CAMPAIGN</div>
  </div>
  <div class="wp">
    <div class="wtb"><div class="wtt"><span>&#128273;</span> SYSTEM_ACCESS.EXE</div><div class="wbs"><div class="wbtn">?</div></div></div>
    <div class="wi">
      <input type="hidden" id="api-key" value="proxy"/>
    </div>
  </div>
  <div class="wp">
    <div class="wtb"><div class="wtt"><span>&#128128;</span> SURVIVOR_PROFILE.DAT</div><div class="wbs"><div class="wbtn">?</div></div></div>
    <div class="wi">
      <div class="fw"><div class="dos-label">SURVIVOR DESIGNATION</div>
        <input type="text" class="dos-input" id="char-name" placeholder="e.g. Governor Skeez Malvetti" maxlength="40"/>
      </div>
      <div class="fw"><div class="dos-label">YOUR FACTION NAME</div>
        <input type="text" class="dos-input" id="faction-name-input" placeholder="e.g. The New Jersey Accord" maxlength="40"/>
        <div class="dos-hint">&gt; TCNJ IS EMPTY. YOU ARE BUILDING SOMETHING FROM NOTHING.</div>
      </div>
      <div class="fw"><div class="dos-label">FACTION CLASS</div>
        <!-- STEP 1: PICK ORIGIN FACTION -->
        <div style="font-size:.5rem;color:var(--gd);letter-spacing:2px;margin-bottom:6px;">STEP 1 â€” SELECT ORIGIN FACTION</div>
        <div class="arch-grid" style="grid-template-columns:1fr 1fr 1fr;">
          <div class="arch-card" data-arch="iron_syndicate" onclick="selectFaction(this)">
            <span class="arch-icon">&#129967;</span>
            <div class="arch-name" style="color:#cc0000">IRON SYNDICATE</div>
            <div class="arch-stat">Newark Factory State</div>
          </div>
          <div class="arch-card" data-arch="rust_eagles" onclick="selectFaction(this)">
            <span class="arch-icon">&#9992;</span>
            <div class="arch-name" style="color:#cc6600">RUST EAGLES</div>
            <div class="arch-stat">McGuire AFB Military</div>
          </div>
          <div class="arch-card" data-arch="mountain_covenant" onclick="selectFaction(this)">
            <span class="arch-icon">&#9968;</span>
            <div class="arch-name" style="color:#0099aa">MTN COVENANT</div>
            <div class="arch-stat">Mountainside Water Cult</div>
          </div>
          <div class="arch-card" data-arch="trenton_collective" onclick="selectFaction(this)">
            <span class="arch-icon">&#127807;</span>
            <div class="arch-name" style="color:#aacc00">TRENTON COLLECTIVE</div>
            <div class="arch-stat">Agrarian Commune</div>
          </div>
          <div class="arch-card" data-arch="coastal_brotherhood" onclick="selectFaction(this)">
            <span class="arch-icon">&#9875;</span>
            <div class="arch-name" style="color:#0066cc">COASTAL BROTHERHOOD</div>
            <div class="arch-stat">LBI Crime Network</div>
          </div>
          <div class="arch-card" data-arch="the_hollowed" onclick="selectFaction(this)">
            <span class="arch-icon">&#128128;</span>
            <div class="arch-name" style="color:#880000">THE HOLLOWED</div>
            <div class="arch-stat">Pine Barrens Raiders</div>
          </div>
        </div>
        <div style="font-size:.5rem;color:var(--gd);letter-spacing:2px;margin-top:10px;margin-bottom:6px;" id="sub-step-label">STEP 2 â€” SELECT SUBCLASS</div>
        <!-- STEP 2: SUBCLASS (shown after archetype pick) -->
        <div class="subclass-panel" id="subclass-panel">
          <div class="sub-header" id="sub-header" style="white-space:normal;line-height:1.5;">SELECT SUBCLASS</div>
          <div class="sub-grid" id="sub-grid"></div>
        </div>
      </div>
      <div class="fw">
        <div class="stat-pts">SKILL POINTS REMAINING: <span id="skill-pts-left">10</span></div>
        <div class="dos-label">STARTING SKILL ALLOCATION</div>
        <div class="skill-alloc-grid">
          <div class="skill-alloc-row">
            <span class="skill-alloc-nm">ðŸ’ª FORCE</span>
            <div class="sk-alloc-btns"><button class="sk-alloc-btn" onclick="allocSkill('force',-1)">-</button><span class="sk-alloc-val" id="alloc-force">0</span><button class="sk-alloc-btn" onclick="allocSkill('force',1)">+</button></div>
            <span class="sk-alloc-hint">Fighting &middot; Intimidation &middot; Troops</span>
          </div>
          <div class="skill-alloc-row">
            <span class="skill-alloc-nm">ðŸ§  WIT</span>
            <div class="sk-alloc-btns"><button class="sk-alloc-btn" onclick="allocSkill('wit',-1)">-</button><span class="sk-alloc-val" id="alloc-wit">0</span><button class="sk-alloc-btn" onclick="allocSkill('wit',1)">+</button></div>
            <span class="sk-alloc-hint">Cunning &middot; Trade &middot; Engineering</span>
          </div>
          <div class="skill-alloc-row">
            <span class="skill-alloc-nm">ðŸ‘‘ INFLUENCE</span>
            <div class="sk-alloc-btns"><button class="sk-alloc-btn" onclick="allocSkill('influence',-1)">-</button><span class="sk-alloc-val" id="alloc-influence">0</span><button class="sk-alloc-btn" onclick="allocSkill('influence',1)">+</button></div>
            <span class="sk-alloc-hint">Charisma &middot; Diplomacy &middot; Leadership</span>
          </div>
          <div class="skill-alloc-row">
            <span class="skill-alloc-nm">ðŸŒ‘ SHADOW</span>
            <div class="sk-alloc-btns"><button class="sk-alloc-btn" onclick="allocSkill('shadow',-1)">-</button><span class="sk-alloc-val" id="alloc-shadow">0</span><button class="sk-alloc-btn" onclick="allocSkill('shadow',1)">+</button></div>
            <span class="sk-alloc-hint">Stealth &middot; Subterfuge &middot; Intel</span>
          </div>
          <div class="skill-alloc-row">
            <span class="skill-alloc-nm">ðŸ”¥ GRIT</span>
            <div class="sk-alloc-btns"><button class="sk-alloc-btn" onclick="allocSkill('grit',-1)">-</button><span class="sk-alloc-val" id="alloc-grit">0</span><button class="sk-alloc-btn" onclick="allocSkill('grit',1)">+</button></div>
            <span class="sk-alloc-hint">Survival &middot; Endurance &middot; Scavenging</span>
          </div>
        </div>
      </div>
      <div class="err" id="setup-error"></div>
      <button class="begin-btn" id="begin-btn" onclick="beginGame()">[ BOOT CAMPAIGN &gt;&gt; ]</button>
    </div>
  </div>
</div>

<div id="game-screen">
  <div class="char-panel">
    <div class="char-hdr">
      SURVIVOR: <span id="panel-name">-</span> &nbsp;|&nbsp; CLASS: <span id="panel-class">-</span><br>
      FACTION: <span id="panel-faction">-</span> &nbsp;|&nbsp; LOCATION: <span id="panel-loc">TCNJ</span>
    </div>
    <div class="res-row">
      <div class="res-chip">DAY: <span id="res-days">0</span></div>
      <div class="res-chip">SUPPLIES: <span id="res-supplies">50</span></div>
      <div class="res-chip">TROOPS: <span id="res-troops">0</span></div>
      <div class="res-chip">GOLD: <span id="res-gold">0</span></div>
      <div class="res-chip">TERR: <span id="res-territories">0</span>/10</div>
      <div class="res-chip" id="amish-chip">AMISH: <span id="res-amish">120d</span></div>
      <div class="res-chip" id="travel-chip">TRAVEL: <span id="res-travel">ON FOOT</span></div>
    </div>
    <div class="ap-row" id="ap-row"></div>
    <div class="hp-label"><span>&#9632; INFLUENCE RATING</span><span id="hp-text">100/100</span></div>
    <div class="hp-track"><div class="hp-fill" id="hp-bar" style="width:100%"></div></div>
  </div>

  <div class="tab-bar">
    <div class="tab active" id="tab-story" onclick="switchTab('story')">&#128221; NARRATIVE</div>
    <div class="tab" id="tab-map" onclick="switchTab('map')">&#128506; MAP</div>
    <div class="tab" id="tab-factions" onclick="switchTab('factions')">&#9876; FACTIONS</div>
    <div class="tab" id="tab-skills" onclick="switchTab('skills')">&#129516; SKILLS</div>
    <div class="tab" id="tab-tasks" onclick="switchTab('tasks')">&#128204; TASKS</div>
  </div>

  <!-- STORY -->
  <div id="story-view">
    <div class="wp" style="margin-top:0;border-top:none;">
      <div class="wtb"><div class="wtt"><span>&#128221;</span> <span id="story-win-title">NARRATIVE_ENGINE.EXE</span></div><div class="wbs"><div class="wbtn">?</div></div></div>
      <div class="wi" style="min-height:180px;"><div id="story-text"></div></div>
    </div>
    <div class="dos-loading" id="dos-loading">&gt; PROCESSING DECISION TREE</div>
    <div class="err" id="game-error"></div>
    <div id="turn-delta-bar" style="display:none;"></div>
    <div class="choices-container" id="choices-container"></div>
    <div class="open-wrap" id="open-wrap" style="display:none;">
      <button class="search-btn" onclick="searchArea()" title="Search area for gold &amp; supplies">&#128270; SEARCH</button>
      <input type="text" class="open-input" id="open-input" placeholder="&gt; TYPE YOUR OWN ACTION..." maxlength="200"/>
      <button class="open-submit" onclick="submitOpen()">[ DO IT ]</button>
    </div>
  </div>

  <!-- MAP -->
  <div id="map-view" style="display:none;">
    <div class="wp" style="margin-top:0;border-top:none;">
      <div class="wtb"><div class="wtt"><span>&#128506;</span> CAMPAIGN_MAP.EXE</div><div class="wbs"><div class="wbtn">?</div></div></div>
      <div style="margin:4px;background:#000;border:2px inset var(--wgd);">
        <div class="map-res-bar">
          <span>DAY: <span id="map-day">0</span></span>
          <span>SUPPLIES: <span id="map-sup">50</span></span>
          <span>TROOPS: <span id="map-trp">0</span></span>
          <span>GOLD: <span id="map-gold">0</span></span>
          <span>LOC: <span id="map-cur-loc">TCNJ</span></span>
        </div>
        <div class="map-wrap" id="map-wrap">
          <svg id="campaign-svg" viewBox="0 0 400 580" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(0,255,65,0.04)" stroke-width="0.4"/></pattern>
              <filter id="glow"><feGaussianBlur stdDeviation="2.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
              <clipPath id="nj-clip"><path d="M135,98 C152,68 182,42 218,25 C252,12 306,4 365,6 C382,8 392,20 393,44 C393,70 388,100 382,128 C377,148 370,162 365,178 C361,192 360,206 370,225 C374,240 374,260 373,276 C370,292 366,310 360,328 C356,344 350,364 338,388 C322,415 306,438 288,464 C272,486 250,506 226,526 C206,540 186,558 168,571 C155,578 143,582 130,581 C116,580 100,573 84,562 C65,547 48,526 32,504 C20,486 10,464 4,442 C0,426 0,408 2,390 C6,370 18,344 36,316 C56,286 76,260 88,234 C95,212 96,190 98,168 C100,150 108,132 118,118 C126,108 132,102 135,98 Z"/></clipPath>
            </defs>
            <!-- â•â•â• CLASSIC BACKGROUND â•â•â• -->
            <g id="map-bg-classic">
              <rect width="400" height="580" fill="#000814"/>
              <text x="370" y="280" font-family="Share Tech Mono" font-size="5.5" fill="rgba(0,80,180,0.2)" text-anchor="middle" transform="rotate(90,370,280)">ATLANTIC OCEAN</text>
              <text x="30" y="520" font-family="Share Tech Mono" font-size="5" fill="rgba(0,80,180,0.18)" text-anchor="middle" transform="rotate(-10,30,520)">DELAWARE BAY</text>
              <g clip-path="url(#nj-clip)">
                <rect width="400" height="580" fill="#050f05"/>
                <rect width="400" height="580" fill="url(#grid)"/>
                <ellipse cx="295" cy="390" rx="75" ry="65" fill="rgba(0,255,65,0.04)" stroke="rgba(0,255,65,0.07)" stroke-width="1" stroke-dasharray="4,6"/>
                <text x="295" y="386" font-family="Share Tech Mono" font-size="5.5" fill="rgba(0,255,65,0.18)" text-anchor="middle">PINE BARRENS</text>
                <text x="295" y="394" font-family="Share Tech Mono" font-size="4.5" fill="rgba(0,255,65,0.12)" text-anchor="middle">[CONTAMINATED]</text>
                <circle cx="270" cy="400" r="1.5" fill="rgba(0,255,65,0.15)"/><circle cx="300" cy="415" r="1" fill="rgba(0,255,65,0.12)"/><circle cx="315" cy="380" r="1.5" fill="rgba(0,255,65,0.1)"/>
              </g>
              <path d="M135,98 C152,68 182,42 218,25 C252,12 306,4 365,6 C382,8 392,20 393,44 C393,70 388,100 382,128 C377,148 370,162 365,178 C361,192 360,206 370,225 C374,240 374,260 373,276 C370,292 366,310 360,328 C356,344 350,364 338,388 C322,415 306,438 288,464 C272,486 250,506 226,526 C206,540 186,558 168,571 C155,578 143,582 130,581 C116,580 100,573 84,562 C65,547 48,526 32,504 C20,486 10,464 4,442 C0,426 0,408 2,390 C6,370 18,344 36,316 C56,286 76,260 88,234 C95,212 96,190 98,168 C100,150 108,132 118,118 C126,108 132,102 135,98 Z" fill="none" stroke="rgba(0,255,65,0.35)" stroke-width="1.5"/>
              <g transform="translate(32,32)"><text x="0" y="-10" font-family="Share Tech Mono" font-size="7" fill="rgba(0,255,65,0.4)" text-anchor="middle">N</text><line x1="0" y1="-8" x2="0" y2="8" stroke="rgba(0,255,65,0.3)" stroke-width="1"/><line x1="-8" y1="0" x2="8" y2="0" stroke="rgba(0,255,65,0.3)" stroke-width="1"/></g>
              <text x="360" y="50" font-family="Share Tech Mono" font-size="5" fill="rgba(255,255,255,0.08)" text-anchor="middle">NEW YORK</text>
              <text x="90" y="185" font-family="Share Tech Mono" font-size="5" fill="rgba(255,255,255,0.08)" text-anchor="middle">PENNSYLVANIA</text>
            </g>
            <!-- â•â•â• COUNTY BACKGROUND â•â•â• -->
            <g id="map-bg-county" style="display:none">
              <rect width="400" height="580" fill="#0a1628"/>
              <text x="380" y="280" font-family="Share Tech Mono" font-size="6" fill="rgba(60,130,200,0.25)" text-anchor="middle" transform="rotate(90,380,280)">ATLANTIC OCEAN</text>
              <text x="28" y="518" font-family="Share Tech Mono" font-size="5" fill="rgba(60,130,200,0.22)" text-anchor="middle" transform="rotate(-10,28,518)">DELAWARE BAY</text>
              <g clip-path="url(#nj-clip)">
                <rect width="400" height="580" fill="#1a1814"/>
                <!-- â”€â”€ County fills (21 counties, very subtle tints) â”€â”€ -->
                <!-- Sussex -->
                <path d="M135,98 C152,68 182,42 218,25 C240,16 255,12 262,14 L248,52 L238,82 L168,96 L135,98Z" fill="rgba(120,160,100,0.07)"/>
                <!-- Passaic -->
                <path d="M262,14 C275,10 290,8 308,8 L302,38 L295,68 L238,82 L248,52Z" fill="rgba(180,130,110,0.06)"/>
                <!-- Bergen -->
                <path d="M308,8 C340,5 365,6 382,8 C390,14 393,28 393,48 L388,68 L380,85 L350,88 L302,72 L302,38Z" fill="rgba(190,150,90,0.06)"/>
                <!-- Warren -->
                <path d="M135,98 L168,96 L168,148 L102,148 L98,168 C100,150 108,132 118,118 L126,108 L132,102Z" fill="rgba(140,160,120,0.06)"/>
                <!-- Morris -->
                <path d="M168,96 L238,82 L295,68 L302,72 L292,98 L288,128 L258,148 L198,155 L168,148Z" fill="rgba(180,130,140,0.06)"/>
                <!-- Essex -->
                <path d="M292,98 L350,88 L375,95 L368,128 L340,132 L288,128Z" fill="rgba(170,150,120,0.06)"/>
                <!-- Hudson -->
                <path d="M350,88 L380,85 C388,90 388,100 385,115 L382,128 L372,145 L368,128 L340,132 L350,110Z" fill="rgba(180,120,120,0.06)"/>
                <!-- Hunterdon -->
                <path d="M102,148 L168,148 L198,155 L178,210 L95,232 L92,210 C95,195 96,178 98,168Z" fill="rgba(180,155,120,0.06)"/>
                <!-- Somerset -->
                <path d="M198,155 L258,148 L260,172 L232,218 L178,210Z" fill="rgba(150,130,110,0.06)"/>
                <!-- Union -->
                <path d="M258,148 L288,128 L340,132 L368,128 L372,145 L370,168 L365,178 L340,178 L295,172 L260,172Z" fill="rgba(170,120,140,0.06)"/>
                <!-- Middlesex -->
                <path d="M260,172 L295,172 L340,178 L365,178 C361,192 360,206 365,215 L375,225 L270,235 L232,218Z" fill="rgba(170,140,150,0.06)"/>
                <!-- Mercer -->
                <path d="M92,232 L178,210 L232,218 L270,235 L252,268 L80,268 C82,258 86,245 88,234Z" fill="rgba(140,120,160,0.06)"/>
                <!-- Monmouth -->
                <path d="M270,235 L375,225 C374,240 374,260 373,276 L370,292 L322,290 L252,268Z" fill="rgba(170,150,110,0.06)"/>
                <!-- Burlington -->
                <path d="M80,268 L252,268 L322,290 L295,380 L158,378 L125,352 L52,315 C60,295 70,278 76,268Z" fill="rgba(120,150,120,0.06)"/>
                <!-- Ocean -->
                <path d="M322,290 L370,292 C366,310 360,328 356,344 L350,364 L338,388 L330,408 L295,380Z" fill="rgba(180,130,120,0.06)"/>
                <!-- Camden -->
                <path d="M52,315 L125,352 L125,365 L80,352 L42,338 C45,325 48,320 52,315Z" fill="rgba(170,120,140,0.06)"/>
                <!-- Gloucester -->
                <path d="M42,338 L80,352 L125,365 L158,378 L142,440 L68,425 L22,395 C28,375 35,358 42,338Z" fill="rgba(160,145,110,0.06)"/>
                <!-- Salem -->
                <path d="M22,395 L68,425 L68,458 L25,465 C15,450 8,438 4,442 C2,420 8,405 15,395Z" fill="rgba(170,160,90,0.06)"/>
                <!-- Cumberland -->
                <path d="M68,458 L142,440 L178,488 L125,542 L75,545 C55,530 38,510 25,490 L25,465Z" fill="rgba(170,160,95,0.06)"/>
                <!-- Atlantic -->
                <path d="M142,440 L158,378 L295,380 L330,408 C322,415 306,438 295,458 L275,482 L178,488Z" fill="rgba(120,155,120,0.06)"/>
                <!-- Cape May -->
                <path d="M125,542 L178,488 L275,482 C268,490 258,498 248,508 L226,526 C206,540 186,558 168,571 C155,578 143,582 130,581 L125,574Z" fill="rgba(170,130,145,0.06)"/>
                <!-- â”€â”€ County boundary lines (traced from reference) â”€â”€ -->
                <g stroke="rgba(200,180,140,0.2)" stroke-width="0.7" fill="none">
                  <!-- Sussex / Passaic -->
                  <path d="M262,14 L248,52 L238,82"/>
                  <!-- Passaic / Bergen -->
                  <path d="M308,8 L302,38 L302,72 L295,68"/>
                  <!-- Sussex-Passaic / Morris (northern tier) -->
                  <path d="M168,96 L210,88 L238,82 L295,68 L292,98"/>
                  <!-- Bergen / Hudson -->
                  <path d="M350,88 L350,110 L340,132"/>
                  <!-- Morris / Essex -->
                  <path d="M292,98 L315,110 L340,132"/>
                  <!-- Warren / Morris-Hunterdon (west side) -->
                  <path d="M102,148 L168,148"/>
                  <!-- Warren / Sussex -->
                  <path d="M135,98 L168,96 L168,148"/>
                  <!-- Morris / Somerset-Union (central) -->
                  <path d="M198,155 L228,150 L258,148 L288,128"/>
                  <!-- Essex-Hudson / Union -->
                  <path d="M288,128 L340,132 L368,128 L372,145 L370,168"/>
                  <!-- Hunterdon / Somerset -->
                  <path d="M198,155 L178,210"/>
                  <!-- Somerset / Middlesex -->
                  <path d="M258,148 L260,172 L270,190"/>
                  <!-- Union / Middlesex -->
                  <path d="M260,172 L295,172 L340,178 L365,178"/>
                  <!-- Hunterdon-Somerset / Mercer -->
                  <path d="M92,232 L140,218 L178,210 L232,218"/>
                  <!-- Middlesex / Mercer-Monmouth -->
                  <path d="M232,218 L270,235"/>
                  <!-- Mercer / Monmouth-Burlington -->
                  <path d="M270,235 L252,268"/>
                  <!-- Mercer / Burlington (Delaware to central) -->
                  <path d="M80,268 L170,268 L252,268"/>
                  <!-- Monmouth / Ocean-Burlington -->
                  <path d="M252,268 L290,278 L322,290"/>
                  <!-- Monmouth / Ocean (coast split) -->
                  <path d="M322,290 L348,305 L370,292"/>
                  <!-- Burlington / Ocean -->
                  <path d="M322,290 L295,380"/>
                  <!-- Burlington / Camden -->
                  <path d="M52,315 L90,338 L125,352"/>
                  <!-- Camden / Gloucester -->
                  <path d="M42,338 L60,345 L80,352 L125,365"/>
                  <!-- Burlington / Gloucester-Atlantic -->
                  <path d="M125,365 L142,378 L158,378"/>
                  <!-- Gloucester / Salem -->
                  <path d="M22,395 L45,412 L68,425"/>
                  <!-- Gloucester / Cumberland-Atlantic -->
                  <path d="M68,425 L105,435 L142,440"/>
                  <!-- Salem / Cumberland -->
                  <path d="M68,458 L68,425"/>
                  <path d="M25,465 L68,458"/>
                  <!-- Burlington-Atlantic / Ocean (south split) -->
                  <path d="M295,380 L315,400 L330,408"/>
                  <!-- Atlantic / Cumberland-Cape May -->
                  <path d="M142,440 L162,465 L178,488"/>
                  <!-- Cape May / Atlantic (coast) -->
                  <path d="M178,488 L225,485 L275,482"/>
                  <!-- Cape May / Cumberland (bay side) -->
                  <path d="M125,542 L150,518 L178,488"/>
                </g>
                <!-- â”€â”€ County name labels â”€â”€ -->
                <g font-family="Share Tech Mono" fill="rgba(200,180,140,0.14)" text-anchor="middle" font-size="4.5">
                  <text x="190" y="58">SUSSEX</text>
                  <text x="275" y="50">PASSAIC</text>
                  <text x="350" y="52">BERGEN</text>
                  <text x="130" y="128">WARREN</text>
                  <text x="235" y="118">MORRIS</text>
                  <text x="320" y="112">ESSEX</text>
                  <text x="372" y="116" font-size="3.5">HUDSON</text>
                  <text x="140" y="185">HUNTERDON</text>
                  <text x="225" y="185">SOMERSET</text>
                  <text x="310" y="155">UNION</text>
                  <text x="310" y="200">MIDDLESEX</text>
                  <text x="168" y="248">MERCER</text>
                  <text x="328" y="258">MONMOUTH</text>
                  <text x="195" y="328">BURLINGTON</text>
                  <text x="340" y="338">OCEAN</text>
                  <text x="82" y="340">CAMDEN</text>
                  <text x="100" y="398">GLOUCESTER</text>
                  <text x="42" y="445">SALEM</text>
                  <text x="100" y="488">CUMBERLAND</text>
                  <text x="230" y="435">ATLANTIC</text>
                  <text x="195" y="528">CAPE MAY</text>
                </g>
                <!-- Pine Barrens contamination zone -->
                <ellipse cx="265" cy="400" rx="80" ry="55" fill="rgba(80,60,30,0.12)" stroke="rgba(120,100,60,0.12)" stroke-width="1" stroke-dasharray="4,6"/>
                <text x="265" y="398" font-family="Share Tech Mono" font-size="5.5" fill="rgba(200,180,140,0.15)" text-anchor="middle">PINE BARRENS</text>
                <text x="265" y="407" font-family="Share Tech Mono" font-size="4" fill="rgba(200,180,140,0.10)" text-anchor="middle">[CONTAMINATED]</text>
              </g>
              <!-- State outline -->
              <path d="M135,98 C152,68 182,42 218,25 C252,12 306,4 365,6 C382,8 392,20 393,44 C393,70 388,100 382,128 C377,148 370,162 365,178 C361,192 360,206 370,225 C374,240 374,260 373,276 C370,292 366,310 360,328 C356,344 350,364 338,388 C322,415 306,438 288,464 C272,486 250,506 226,526 C206,540 186,558 168,571 C155,578 143,582 130,581 C116,580 100,573 84,562 C65,547 48,526 32,504 C20,486 10,464 4,442 C0,426 0,408 2,390 C6,370 18,344 36,316 C56,286 76,260 88,234 C95,212 96,190 98,168 C100,150 108,132 118,118 C126,108 132,102 135,98 Z" fill="none" stroke="rgba(200,180,140,0.45)" stroke-width="1.5"/>
              <!-- Neighboring state labels -->
              <text x="365" y="42" font-family="Share Tech Mono" font-size="5.5" fill="rgba(200,180,140,0.15)" text-anchor="end">NEW YORK</text>
              <text x="68" y="175" font-family="Share Tech Mono" font-size="5.5" fill="rgba(200,180,140,0.15)" text-anchor="middle">PENNSYLVANIA</text>
              <text x="40" y="530" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,180,140,0.12)" text-anchor="middle">DELAWARE</text>
            </g>
            <!-- â•â•â• CLASSIC ROADS â•â•â• -->
            <g id="map-roads-classic">
              <line x1="200" y1="112" x2="332" y2="149" class="road" id="road-meridian-newark" stroke-dasharray="4,6"/>
              <line x1="200" y1="112" x2="288" y2="163" class="road" id="road-meridian-mountainside" stroke-dasharray="4,6"/>
              <path d="M192,493 C200,460 210,410 225,365 C240,325 275,330 355,338" fill="none" class="road" id="road-capemay-lbi" stroke-dasharray="3,8"/>
              <line x1="332" y1="149" x2="288" y2="163" class="road" id="road-newark-mountainside"/>
              <path d="M332,153 C310,180 270,210 240,235 C215,255 200,258 187,259" fill="none" class="road" id="road-newark-tcnj"/>
              <path d="M288,167 C260,190 230,220 210,245 C200,252 193,256 187,259" fill="none" class="road" id="road-mside-tcnj"/>
              <line x1="187" y1="263" x2="196" y2="273" class="road" id="road-tcnj-trenton"/>
              <path d="M196,276 C205,295 218,310 228,319" fill="none" class="road" id="road-trenton-mcguire"/>
              <line x1="190" y1="263" x2="231" y2="321" class="road" id="road-tcnj-mcguire"/>
              <path d="M238,323 C270,325 310,330 355,337" fill="none" class="road" id="road-mcguire-lbi"/>
              <path d="M338,155 C350,200 362,270 360,337" fill="none" class="road" id="road-newark-lbi" stroke-dasharray="5,7"/>
              <path d="M234,324 C255,350 280,385 302,408" fill="none" class="road" id="road-mcguire-pine_barrens" stroke-dasharray="3,5"/>
              <path d="M357,340 C340,360 325,385 308,408" fill="none" class="road" id="road-lbi-pine_barrens" stroke-dasharray="3,5"/>
            </g>
            <!-- â•â•â• COUNTY ROADS (populated by JS) â•â•â• -->
            <g id="map-roads-county" style="display:none"></g>
            <!-- â•â•â• PRIMARY LOCATION NODES â•â•â• -->
            <g class="loc-node ctrl-hostile" id="node-newark" onclick="clickLoc('newark')" transform="translate(332,149)">
              <circle class="outer" cx="0" cy="0" r="13" filter="url(#glow)"/><circle class="inner" cx="0" cy="0" r="6"/>
              <text x="0" y="-18" font-family="Share Tech Mono" font-size="6.5" text-anchor="middle" class="node-lbl">NEWARK</text>
              <text x="0" y="-10" font-family="Share Tech Mono" font-size="4" text-anchor="middle" class="node-sub">[IRON SYNDICATE]</text>
            </g>
            <g class="loc-node ctrl-neutral" id="node-mountainside" onclick="clickLoc('mountainside')" transform="translate(288,163)">
              <circle class="outer" cx="0" cy="0" r="11"/><circle class="inner" cx="0" cy="0" r="5.5"/>
              <text x="-15" y="5" font-family="Share Tech Mono" font-size="5.5" text-anchor="end" class="node-lbl">MTNSIDE</text>
              <text x="-15" y="12" font-family="Share Tech Mono" font-size="4" text-anchor="end" class="node-sub">[COVENANT]</text>
            </g>
            <g class="loc-node ctrl-player current-loc" id="node-tcnj" onclick="clickLoc('tcnj')" transform="translate(187,259)">
              <circle class="outer" cx="0" cy="0" r="14" filter="url(#glow)"/><circle class="inner" cx="0" cy="0" r="7"/>
              <text x="0" y="-19" font-family="Share Tech Mono" font-size="7" text-anchor="middle" class="node-lbl">TCNJ</text>
              <text x="0" y="-11" font-family="Share Tech Mono" font-size="4" text-anchor="middle" class="node-sub">[YOUR BASE]</text>
            </g>
            <g class="loc-node ctrl-neutral" id="node-trenton" onclick="clickLoc('trenton')" transform="translate(196,273)">
              <circle class="outer" cx="0" cy="0" r="11"/><circle class="inner" cx="0" cy="0" r="5.5"/>
              <text x="15" y="5" font-family="Share Tech Mono" font-size="5.5" text-anchor="start" class="node-lbl">TRENTON</text>
              <text x="15" y="12" font-family="Share Tech Mono" font-size="4" text-anchor="start" class="node-sub">[COLLECTIVE]</text>
            </g>
            <g class="loc-node ctrl-hostile" id="node-mcguire" onclick="clickLoc('mcguire')" transform="translate(231,321)">
              <circle class="outer" cx="0" cy="0" r="13" filter="url(#glow)"/><circle class="inner" cx="0" cy="0" r="6.5"/>
              <text x="-16" y="4" font-family="Share Tech Mono" font-size="5.5" text-anchor="end" class="node-lbl">McGUIRE</text>
              <text x="-16" y="11" font-family="Share Tech Mono" font-size="4" text-anchor="end" class="node-sub">[RUST EAGLES]</text>
            </g>
            <g class="loc-node ctrl-neutral" id="node-lbi" onclick="clickLoc('lbi')" transform="translate(358,338)">
              <circle class="outer" cx="0" cy="0" r="11"/><circle class="inner" cx="0" cy="0" r="5.5"/>
              <text x="0" y="-16" font-family="Share Tech Mono" font-size="5.5" text-anchor="middle" class="node-lbl">LBI</text>
              <text x="0" y="-9" font-family="Share Tech Mono" font-size="4" text-anchor="middle" class="node-sub">[BROTHERHOOD]</text>
            </g>
            <g class="loc-node ctrl-unclaimed" id="node-meridian_biolabs" onclick="clickLoc('meridian_biolabs')" transform="translate(200,108)">
              <circle class="outer" cx="0" cy="0" r="11"/><circle class="inner" cx="0" cy="0" r="5.5"/>
              <text x="-13" y="4" font-family="Share Tech Mono" font-size="5.5" text-anchor="end" class="node-lbl">BRANTOVER</text>
              <text x="-13" y="11" font-family="Share Tech Mono" font-size="4" text-anchor="end" class="node-sub">[AI-LABS]</text>
            </g>
            <g class="loc-node ctrl-neutral" id="node-cape_may" onclick="clickLoc('cape_may')" transform="translate(190,490)">
              <circle class="outer" cx="0" cy="0" r="11"/><circle class="inner" cx="0" cy="0" r="5.5"/>
              <text x="0" y="-16" font-family="Share Tech Mono" font-size="5.5" text-anchor="middle" class="node-lbl">CAPE MAY</text>
              <text x="0" y="-9" font-family="Share Tech Mono" font-size="4" text-anchor="middle" class="node-sub">[MUNICIPAL]</text>
            </g>
            <g class="loc-node ctrl-hostile" id="node-pine_barrens" onclick="clickLoc('pine_barrens')" transform="translate(305,410)">
              <circle class="outer" cx="0" cy="0" r="12" filter="url(#glow)"/><circle class="inner" cx="0" cy="0" r="5.5"/>
              <text x="15" y="0" font-family="Share Tech Mono" font-size="5.5" text-anchor="start" class="node-lbl">PINE BARRENS</text>
              <text x="15" y="7" font-family="Share Tech Mono" font-size="4" text-anchor="start" class="node-sub">[HOLLOWED / &#9888; DEVIL]</text>
            </g>
            <g class="loc-node ctrl-neutral" id="node-atlantic_city" onclick="clickLoc('atlantic_city')" transform="translate(268,475)">
              <circle class="outer" cx="0" cy="0" r="11"/><circle class="inner" cx="0" cy="0" r="5.5"/>
              <text x="0" y="-16" font-family="Share Tech Mono" font-size="5.5" text-anchor="middle" class="node-lbl">ATLCT</text>
              <text x="0" y="-9" font-family="Share Tech Mono" font-size="4" text-anchor="middle" class="node-sub">[SUBNET CASINO]</text>
            </g>
            <!-- â•â•â• SECONDARY TOWNS (original) â•â•â• -->
            <g class="town-node" id="node-hoboken" onclick="clickLoc('hoboken')" transform="translate(369,152)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">HBKN</text></g>
            <g class="town-node" id="node-port_elizabeth" onclick="clickLoc('port_elizabeth')" transform="translate(330,172)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="14" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">PRTELZ</text></g>
            <g class="town-node" id="node-newark_airport" onclick="clickLoc('newark_airport')" transform="translate(346,164)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">NWKAIR</text></g>
            <g class="town-node" id="node-middlesex" onclick="clickLoc('middlesex')" transform="translate(258,196)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">MDLSX</text></g>
            <g class="town-node" id="node-asbury_ruins" onclick="clickLoc('asbury_ruins')" transform="translate(368,278)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">ASBRY</text></g>
            <g class="town-node" id="node-bound_brook" onclick="clickLoc('bound_brook')" transform="translate(245,202)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">BNDBRK</text></g>
            <g class="town-node" id="node-metuchen" onclick="clickLoc('metuchen')" transform="translate(292,204)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">MTCHN</text></g>
            <g class="town-node" id="node-dunellen" onclick="clickLoc('dunellen')" transform="translate(264,192)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">DUNLN</text></g>
            <g class="town-node" id="node-manville" onclick="clickLoc('manville')" transform="translate(238,210)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">MNVLL</text></g>
            <g class="town-node" id="node-netcong" onclick="clickLoc('netcong')" transform="translate(224,124)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">NTCNG</text></g>
            <!-- â•â•â• NEW COUNTY TOWNS â•â•â• -->
            <g class="town-node" id="node-newton" onclick="clickLoc('newton')" transform="translate(170,72)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">NWTN</text></g>
            <g class="town-node" id="node-paterson" onclick="clickLoc('paterson')" transform="translate(290,100)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">PTRN</text></g>
            <g class="town-node" id="node-hackensack" onclick="clickLoc('hackensack')" transform="translate(340,90)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">HCKNSK</text></g>
            <g class="town-node" id="node-belvidere" onclick="clickLoc('belvidere')" transform="translate(140,115)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">BLVDR</text></g>
            <g class="town-node" id="node-morristown" onclick="clickLoc('morristown')" transform="translate(255,120)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">MRTWN</text></g>
            <g class="town-node" id="node-jersey_city" onclick="clickLoc('jersey_city')" transform="translate(370,130)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">JRCTY</text></g>
            <g class="town-node" id="node-flemington" onclick="clickLoc('flemington')" transform="translate(165,210)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">FLMTN</text></g>
            <g class="town-node" id="node-somerville" onclick="clickLoc('somerville')" transform="translate(225,195)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="0" y="-12" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="middle">SMRVL</text></g>
            <g class="town-node" id="node-new_brunswick" onclick="clickLoc('new_brunswick')" transform="translate(275,205)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">NWBRK</text></g>
            <g class="town-node" id="node-freehold" onclick="clickLoc('freehold')" transform="translate(328,260)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">FRHOLD</text></g>
            <g class="town-node" id="node-mount_holly" onclick="clickLoc('mount_holly')" transform="translate(195,345)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">MTHLY</text></g>
            <g class="town-node" id="node-toms_river" onclick="clickLoc('toms_river')" transform="translate(338,355)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">TMSRV</text></g>
            <g class="town-node" id="node-camden" onclick="clickLoc('camden')" transform="translate(148,370)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">CMDN</text></g>
            <g class="town-node" id="node-woodbury" onclick="clickLoc('woodbury')" transform="translate(135,395)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">WDBRY</text></g>
            <g class="town-node" id="node-salem" onclick="clickLoc('salem')" transform="translate(80,435)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="-12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="end">SALEM</text></g>
            <g class="town-node" id="node-bridgeton" onclick="clickLoc('bridgeton')" transform="translate(120,465)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">BRGTN</text></g>
            <g class="town-node" id="node-mays_landing" onclick="clickLoc('mays_landing')" transform="translate(235,445)"><rect class="town-diamond" x="-5" y="-5" width="10" height="10" transform="rotate(45)"/><text x="12" y="4" font-family="Share Tech Mono" font-size="4.5" fill="rgba(200,200,200,0.55)" text-anchor="start">MYSLND</text></g>
            <!-- â•â•â• PATROL DOTS â•â•â• -->
            <circle class="patrol-dot" id="patrol1" cx="332" cy="149" r="3.5"/>
            <circle class="patrol-dot" id="patrol2" cx="231" cy="321" r="3.5"/>
          </svg>
          <div class="map-legend">
            <div><div class="leg-dot" style="background:var(--g)"></div>PLAYER</div>
            <div><div class="leg-dot" style="background:var(--blood)"></div>HOSTILE</div>
            <div><div class="leg-dot" style="background:var(--a)"></div>NEUTRAL</div>
            <div><div class="leg-dot" style="background:#ff8800"></div>CONTESTED</div>
          </div>
          <div class="loc-popup" id="loc-popup" style="display:none;">
            <div class="loc-popup-inner">
              <div class="lpop-tb" id="lpop-tb">LOCATION.DAT</div>
              <div class="lpop-body">
                <div class="lpop-name" id="lpop-name">-</div>
                <div class="lpop-leader" id="lpop-leader">-</div>
                <div class="lpop-ctrl" id="lpop-ctrl">-</div>
                <div class="lpop-feat" id="lpop-feat">-</div>
                <div class="lpop-cost" id="lpop-cost">-</div>
                <div class="lpop-btns">
                  <button class="lpop-btn" id="lpop-travel-btn" onclick="travelToSelected()">[ TRAVEL ]</button>
                  <button class="lpop-btn" id="lpop-talk-btn" onclick="talkFromMap()" style="display:none">[ TALK ]</button>
                  <button class="lpop-btn" onclick="closePopup()">[ CLOSE ]</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- FACTIONS -->
  <div id="factions-view" style="display:none;">
    <div class="wp" style="margin-top:0;border-top:none;">
      <div class="wtb"><div class="wtt"><span>&#9876;</span> FACTION_RELATIONS.DAT</div><div class="wbs"><div class="wbtn">?</div></div></div>
      <div class="wi"><div class="faction-list" id="faction-list"></div></div>
    </div>
  </div>

  <!-- TASKS / OBJECTIVES -->
  <div id="tasks-view" style="display:none;">
    <div class="wp" style="margin-top:0;border-top:none;">
      <div class="wtb"><div class="wtt"><span>&#128204;</span> OBJECTIVES.DAT</div><div class="wbs"><div class="wbtn">?</div></div></div>
      <div class="wi"><div id="tasks-list"></div></div>
    </div>
  </div>

  <!-- DIALOGUE -->
  <div id="dialogue-screen">
    <div class="wp" style="margin-top:0;border-top:none;">
      <div class="wtb"><div class="wtt"><span>&#128172;</span> <span id="dlg-win-title">DIALOGUE.EXE</span></div><div class="wbs"><div class="wbtn">?</div></div></div>
      <div class="wi">
        <div class="dlg-wrap">
          <div class="dlg-portrait">
            <div class="port-ascii" id="port-ascii"></div>
            <div>
              <div class="port-name" id="port-name">-</div>
              <div class="port-title" id="port-title">-</div>
              <div class="port-rel" id="port-rel">-</div>
            </div>
          </div>
          <div class="dlg-text" id="dlg-text">...</div>
          <div class="dos-loading" id="dlg-loading">&gt; PROCESSING RESPONSE</div>
          <div class="dlg-choices" id="dlg-choices"></div>
          <div class="dlg-open-wrap">
            <input type="text" class="open-input" id="dlg-open" placeholder="&gt; SAY SOMETHING CUSTOM..." maxlength="200"/>
            <button class="open-submit" onclick="submitDlgOpen()">[ SAY IT ]</button>
          </div>
          <button class="dlg-back" onclick="closeDialogue()">[ &larr; BACK TO FACTIONS ]</button>
        </div>
      </div>
    </div>
  </div>

  <!-- SKILLS -->
  <div id="skills-view" style="display:none;">
    <div class="wp" style="margin-top:0;border-top:none;">
      <div class="wtb"><div class="wtt"><span>&#129516;</span> SKILL_TREE.EXE &mdash; ACTION POINTS</div><div class="wbs"><div class="wbtn">?</div></div></div>
      <div class="wi">
        <div class="skills-info">TOTAL BANKED AP: <span id="total-ap">0</span> &nbsp;|&nbsp; AP earned by doing actions in each skill.<br>More skill XP = <span>more AP per action</span> = more powerful options unlocked.<br>AP is <span>BANKABLE</span>. Spend it to boost a critical action, or save for emergencies.</div>
        <div class="skill-grid" id="skill-grid"></div>
      </div>
    </div>
  </div>

  <div class="turn-info">
    <span id="turn-counter">&gt; TURN 001</span>
  </div>
</div>
</div>

<div class="load-overlay" id="load-overlay">
  <div class="load-box">
    <div class="load-tb">
      <span>&#9881; NARRATIVE_ENGINE.EXE</span>
      <span id="load-turn-lbl" style="opacity:.7;font-size:.55rem;"></span>
    </div>
    <div class="load-body">
      <div class="load-spinner">
        <svg viewBox="0 0 48 48"><circle class="pip-ring" cx="24" cy="24" r="19"/><circle class="pip-ring2" cx="24" cy="24" r="12"/></svg>
        <div class="pip-label" id="pip-label">[!]</div>
      </div>
      <div class="load-info">
        <div class="load-status" id="load-status-txt">PROCESSING<span class="load-dots"></span></div>
        <div class="load-sub" id="load-sub-txt">Consulting the wasteland...</div>
        <div class="load-bar-track"><div class="load-bar-fill" id="load-bar-fill"></div></div>
      </div>
    </div>
  </div>
</div>

<script src="js/game.js" defer></script>

<!-- SETTINGS / TUTORIAL / LORE MODAL -->
<div class="settings-modal" id="settings-modal" style="display:none;" onclick="if(event.target===this)closeSettings()">
  <div class="settings-win">
    <div class="settings-tb">
      <span>&#9881; LEROY_SETTINGS.EXE</span>
      <button class="settings-close" onclick="closeSettings()">&#10005;</button>
    </div>
    <div class="settings-tabs-row">
      <button class="stab-btn active" id="stabtn-settings" onclick="settingsTab('settings')">SETTINGS</button>
      <button class="stab-btn" id="stabtn-tutorial" onclick="settingsTab('tutorial')">TUTORIAL</button>
      <button class="stab-btn" id="stabtn-lore" onclick="settingsTab('lore')">LORE</button>
    </div>
    <div class="settings-body">
      <div id="stab-settings" class="stab-content">
        <!-- Populated by renderSettingsTab() -->
      </div>
      <div id="stab-tutorial" class="stab-content" style="display:none;">
        <h3>&#9658; THE WORLD</h3>
        In 2669, 92% of humanity evacuated Earth in an event known as &ldquo;The Departure.&rdquo; The 8% left behind in New Jersey have been on their own for 330 years. Technology froze at 2066. Six factions now control what remains of the Garden State. Pennsylvania is occupied by the Amish. New York severed all bridges and tunnels. You are on your own.
        <h3>&#9658; OBJECTIVE</h3>
        Unite or dominate all factions of New Jersey 2999. Win by controlling all <strong>10 primary locations</strong> on the map, or by resolving every faction &mdash; ally them (Relation 66+) or conquer them (Relation 0 + their home territory captured). Any combination works. Your HP hits 0 and you die. The <span style="color:#c8a84b">Yee Amish</span> arrive on Day 120 regardless &mdash; resolve the state before then.
        <h3>&#9658; AMISH CLOCK</h3>
        The <span style="color:#c8a84b">AMISH</span> chip in the resource bar counts down from Day 120. When it hits 0, Ezikio&rsquo;s forces cross the Delaware. If you brokered a deal with Ezikio earlier, there&rsquo;s a 50% chance they honor it. If not &mdash; it&rsquo;s over. Plan accordingly.
        <h3>&#9658; EACH TURN</h3>
        Read the narrative. Choose A / B / C, or type your own action in the input at the bottom. Each preset choice earns Action Points (AP) in a skill. Custom actions can do anything the AI allows and earn AP if they match a skill.
        <h3>&#9658; TRAVEL</h3>
        Open a location on the MAP tab. <span style="color:var(--g)">&#9670; Diamonds</span> are secondary towns with random encounters. <span style="color:var(--g)">&#9679; Circles</span> are primary locations. Choose your travel method:<br><br>
        <span style="color:var(--g)">ON FOOT</span> &mdash; Slowest. No extra cost.<br>
        <span style="color:var(--g)">HORSE</span> &mdash; 45% faster. Costs slightly more supplies.<br>
        <span style="color:var(--g)">VEHICLE</span> &mdash; 80% faster. Costs 8 gold for fuel per trip.
        <h3>&#9658; SKILLS</h3>
        &#128170; FORCE &mdash; Combat, intimidation, troop command<br>
        &#129504; WIT &mdash; Trade, engineering, cunning plans<br>
        &#128081; INFLUENCE &mdash; Diplomacy, persuasion, politics<br>
        &#127761; SHADOW &mdash; Stealth, espionage, subterfuge<br>
        &#128293; GRIT &mdash; Survival, scavenging, endurance<br><br>
        Earn AP by choosing actions. Higher levels unlock Perks. Spend AP to boost your next relevant action.
        <h3>&#9658; RESOURCES</h3>
        HP &mdash; Your health. Reaches 0 and you die. Taking damage compounds your cumulative death risk &mdash; the more you&rsquo;ve been hurt throughout the campaign, the more dangerous each subsequent hit becomes.<br>
        SUPPLIES &mdash; Required for travel and operations.<br>
        TROOPS &mdash; Your military force. 0 troops limits options to stealth and diplomacy.<br>
        GOLD &mdash; Currency for trade, bribes, vehicle fuel, and the Atlantic City blackjack table.
        <h3>&#9658; FACTIONS</h3>
        7 in-state factions plus the Yee Amish external threat. Visit the FACTIONS tab for direct dialogue with faction leaders. Relation score 0&ndash;100: hostile at 0, allied at 66+. <span style="color:#00ddff">Subnet</span> is only accessible after traveling to Cape May Municipal in person. <span style="color:var(--a)">Atlantic City Casino</span> is run by employees who have never met whoever owns the place &mdash; neutral ground for all factions.
        <h3>&#9658; MAP &amp; LOCATIONS</h3>
        Controlling a primary location earns passive supply and gold income every turn. Garrison troops there to defend while you are away. <span style="color:#66aaff">Brantover AI-Powered Biolabs</span> and <span style="color:var(--g)">TCNJ Campus</span> can be claimed without combat.
        <h3>&#9658; SAVE</h3>
        Auto-saves to browser local storage after every turn. Progress persists between sessions on the same device.
      </div>
      <div id="stab-lore" class="stab-content" style="display:none;">
        <!-- Populated by renderLoreTab() -->
      </div>
    </div>
  </div>
</div>

<!-- DEV PANEL MODAL (only shown in ?dev=1 mode) -->
<div class="dev-modal" id="dev-modal" style="display:none;" onclick="if(event.target===this)closeDevPanel()">
  <div class="dev-win">
    <div class="dev-tb">
      <span>&#9881; LEROY_DEVLOG.EXE</span>
      <button class="dev-close" onclick="closeDevPanel()">&#10005;</button>
    </div>
    <div class="dev-body">
      <div class="dev-stat-row">
        <span id="dev-event-count">0 events</span>
        <span class="dev-status">&#9679; DEV MODE ACTIVE</span>
      </div>
      <div id="dev-quick-stats" class="dev-quick-stats"></div>
      <div class="dev-btns">
        <button class="dev-btn dev-btn-export" onclick="exportDevLog()">[ &#11015; EXPORT HTML REPORT ]</button>
        <button class="dev-btn dev-btn-clear" onclick="if(confirm('Clear all log data?'))clearDevLog()">[ &#10005; CLEAR LOG ]</button>
        <button class="dev-btn" onclick="closeDevPanel()">[ CLOSE ]</button>
      </div>
      <div id="dev-leaderboard" class="dev-lb-section"></div>
      <div class="dev-recent-hdr">RECENT EVENTS (LAST 20)</div>
      <div class="dev-table-wrap">
        <table id="dev-recent"></table>
      </div>
    </div>
  </div>
</div>

<!-- DEV FAB â€” floating button, only visible when ?dev=1 -->
<button class="dev-fab" id="dev-fab" style="display:none;" onclick="openDevPanel()">&#9881; DEV</button>
</body>
</html>
